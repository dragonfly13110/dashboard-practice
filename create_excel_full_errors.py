# -*- coding: utf-8 -*-
import openpyxl
from openpyxl.styles import Font, Alignment, PatternFill, Border, Side

# Create workbook and worksheet
wb = openpyxl.Workbook()
ws = wb.active
ws.title = "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£"

# Define styles
header_font = Font(bold=True, color="FFFFFF", size=11)
header_fill = PatternFill(start_color="1565C0", end_color="1565C0", fill_type="solid")
subheader_fill = PatternFill(start_color="42A5F5", end_color="42A5F5", fill_type="solid")
error_fill = PatternFill(start_color="FFCDD2", end_color="FFCDD2", fill_type="solid")
correct_fill = PatternFill(start_color="C8E6C9", end_color="C8E6C9", fill_type="solid")
thin_border = Border(
    left=Side(style='thin'),
    right=Side(style='thin'),
    top=Side(style='thin'),
    bottom=Side(style='thin')
)

# ============================================
# ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î #1: ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô (Multi-level Headers)
# ============================================
# Row 1: Title spanning all columns (MERGED)
ws.merge_cells('A1:N1')
ws['A1'] = "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2567"
ws['A1'].font = Font(bold=True, size=14)
ws['A1'].alignment = Alignment(horizontal='center', vertical='center')

# Row 2: Sub-title (MERGED)
ws.merge_cells('A2:N2')
ws['A2'] = "‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á"
ws['A2'].font = Font(bold=True, size=12)
ws['A2'].alignment = Alignment(horizontal='center', vertical='center')

# Row 3: Empty row (common mistake - empty rows before data)
# Just leave it empty

# Row 4: First level headers with MERGED cells
ws.merge_cells('A4:A5')  # ‡∏•‡∏≥‡∏î‡∏±‡∏ö
ws['A4'] = "‡∏•‡∏≥‡∏î‡∏±‡∏ö"
ws.merge_cells('B4:D4')  # ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á (merged 3 columns)
ws['B4'] = "‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á"
ws.merge_cells('E4:E5')  # ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£
ws['E4'] = "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£"
ws.merge_cells('F4:F5')  # ‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å
ws['F4'] = "‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å"
ws.merge_cells('G4:I4')  # ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (merged 3 columns)
ws['G4'] = "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï"
ws.merge_cells('J4:J5')  # ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
ws['J4'] = "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
ws.merge_cells('K4:L4')  # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (merged 2 columns)
ws['K4'] = "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠"
ws.merge_cells('M4:M5')  # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ
ws['M4'] = "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏ö‡∏≤‡∏ó)"
ws.merge_cells('N4:N5')  # ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
ws['N4'] = "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î"

# Row 5: Second level headers (sub-headers)
ws['B5'] = "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î"
ws['C5'] = "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠"
ws['D5'] = "‡∏ï‡∏≥‡∏ö‡∏•"
ws['G5'] = "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)"
ws['H5'] = "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏Å‡∏Å.)"
ws['I5'] = "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï/‡πÑ‡∏£‡πà"
ws['K5'] = "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£"
ws['L5'] = "LINE ID"

# Style headers (Row 4-5)
for row in [4, 5]:
    for col in range(1, 15):
        cell = ws.cell(row=row, column=col)
        cell.font = header_font
        cell.fill = header_fill if row == 4 else subheader_fill
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        cell.border = thin_border

# ============================================
# Data with various errors
# ============================================
data = [
    # Row 6: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (reference)
    [1, "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø", "‡∏ö‡∏≤‡∏á‡∏Å‡∏≠‡∏Å‡∏ô‡πâ‡∏≠‡∏¢", "‡∏≠‡∏£‡∏∏‡∏ì‡∏≠‡∏°‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ", "‡∏Ç‡πâ‡∏≤‡∏ß", 50, 2500, "=H6/G6", "15/03/2567", "0812345678", "@somchai", 125000, "‚úì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á - ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á"],
    
    # Row 7: ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏∞‡∏Å‡∏î‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô
    [2, "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û", "‡∏ö‡∏≤‡∏á‡∏Å‡∏≠‡∏Å‡∏ô‡πâ‡∏≠‡∏¢", "‡∏≠‡∏£‡∏∏‡∏ì‡∏≠‡∏°‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ", "‡∏Ç‡πâ‡∏≤‡∏ß", 50, 2500, "=H7/G7", "15/03/2567", "0812345678", "@somchai", 125000, "‚úó Inconsistent spelling: ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û vs ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø"],
    
    # Row 8: ‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡πà‡∏≤‡∏á
    [3, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏á‡∏°‡∏≤‡∏•‡∏µ ‡∏™‡∏ß‡∏ô‡∏î‡∏≠‡∏Å", "‡∏ú‡∏±‡∏Å", -5, 300, "=H8/G8", "20/03/67", "0823456789", "", 15000, "‚úó ‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö, ‡∏õ‡∏µ‡∏¢‡πà‡∏≠ 67 vs 2567, LINE ‡∏ß‡πà‡∏≤‡∏á"],
    
    # Row 9: ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ó‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
    [4, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏á‡∏°‡∏≤‡∏•‡∏µ ‡∏™‡∏ß‡∏ô‡∏î‡∏≠‡∏Å", "‡∏ú‡∏±‡∏Å", 5, "‡∏™‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏¢", "#VALUE!", "20/03/2567", "0823456789", "@mali", 15000, "‚úó '‡∏™‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏¢' ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç, ‡∏™‡∏π‡∏ï‡∏£ Error"],
    
    # Row 10: Missing value (‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏á)
    [5, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "", "‡∏ú‡∏±‡∏Å", 10, 500, "=H10/G10", "21/03/2567", "0823456789", "@noname", 25000, "‚úó ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ß‡πà‡∏≤‡∏á (Missing)"],
    
    # Row 11: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    [6, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡∏£‡∏±‡∏Å‡∏ô‡∏≤", "‡∏Ç‡πâ‡∏≤‡∏ß", 100, 5000, "=H11/G11", "32/03/2567", "0834567890", "@prayuth", 250000, "‚úó ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 32 ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏à‡∏£‡∏¥‡∏á"],
    
    # Row 12: ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏°‡∏µ‡∏Ç‡∏µ‡∏î, ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
    [7, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡πÇ‡∏û‡∏ò‡∏≤‡∏£‡∏≤‡∏°", "‡πÄ‡∏ï‡∏≤‡∏õ‡∏π‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏ó‡∏≠‡∏á‡∏î‡∏µ ‡∏°‡∏±‡πà‡∏á‡∏°‡∏µ", "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß", "‡∏™‡∏¥‡∏ö‡∏´‡πâ‡∏≤", 3000, "#VALUE!", "01/04/2567", "081-234-5678", "@tongdee", 180000, "‚úó ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏µ‡∏Ç‡∏µ‡∏î"],
    
    # Row 13: ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á
    [8, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡πÇ‡∏û‡∏ò‡∏≤‡∏£‡∏≤‡∏°", "‡πÄ‡∏ï‡∏≤‡∏õ‡∏π‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏ó‡∏≠‡∏á‡∏î‡∏µ ‡∏°‡∏±‡πà‡∏á‡∏°‡∏µ", "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß", 15, 3000, "=H13/G13", "1 ‡πÄ‡∏°.‡∏¢. 67", "0812345678", "@tongdee", 180000, "‚úó ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡πà‡∏≤‡∏á '1 ‡πÄ‡∏°.‡∏¢. 67'"],
    
    # Row 14: ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏¢‡πà‡∏≠‡∏ï‡πà‡∏≤‡∏á
    [9, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡πÇ‡∏û‡∏ò‡∏≤‡∏£‡∏≤‡∏°", "‡πÄ‡∏ï‡∏≤‡∏õ‡∏π‡∏ô", "‡∏ô.‡∏™.‡∏™‡∏∏‡∏î‡∏≤ ‡∏£‡∏±‡∏Å‡∏©‡πå‡∏î‡∏¥‡∏ô", "‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á", 3, 150, "=H14/G14", "05/04/2567", "0845678901", "@suda", 7500, "‚úó ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ ‡∏ô.‡∏™. vs ‡∏ô‡∏≤‡∏á/‡∏ô‡∏≤‡∏¢"],
    
    # Row 15: N/A ‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
    [10, "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏î‡∏µ", "‡∏Å‡∏∏‡πâ‡∏á", 20, 10000, "=H15/G15", "10/04/2567", "N/A", "N/A", 500000, "‚úó N/A ‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô blank)"],
    
    # Row 16: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
    [11, "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏î‡∏µ", "‡∏Å‡∏∏‡πâ‡∏á", 20, 10000, "=H16/G16", "10/04/2567", "0856789012", "@wichai", "5 ‡πÅ‡∏™‡∏ô", "‚úó ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠"],
    
    # Row 17: Duplicate row
    [12, "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏î‡∏µ", "‡∏Å‡∏∏‡πâ‡∏á", 20, 10000, "=H17/G17", "10/04/2567", "0856789012", "@wichai", 500000, "‚úó ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥ (Duplicate)"],
    
    # Row 18: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    [13, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô", "‡∏Å‡∏£‡∏∞‡∏ï‡∏µ‡∏ö", "‡∏ô‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡∏∏‡∏ç‡∏°‡∏µ", "‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î", 25, 12500, "=H18/G18", "15/04/2567", "0867890123", "@noi", 62500, "‚úì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"],
    
    # Row 19: Outlier
    [14, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô", "‡∏Å‡∏£‡∏∞‡∏ï‡∏µ‡∏ö", "‡∏ô‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà ‡πÉ‡∏à‡∏Å‡∏•‡πâ‡∏≤", "‡∏≠‡πâ‡∏≠‡∏¢", 100, 999999, "=H19/G19", "16/04/2567", "0878901234", "@yai", 4999995, "‚úó Outlier: ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï 999,999 ‡∏Å‡∏Å."],
    
    # Row 20: Logic error (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 0 ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï)
    [15, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô", "‡∏Å‡∏£‡∏∞‡∏ï‡∏µ‡∏ö", "‡∏ô‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà ‡πÉ‡∏à‡∏Å‡∏•‡πâ‡∏≤", "‡∏≠‡πâ‡∏≠‡∏¢", 0, 5000, "#DIV/0!", "17/04/2567", "0878901234", "@yai", 25000, "‚úó Logic Error: ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà=0 ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï"],
    
    # Row 21: ‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°
    [16, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å", "‡∏î‡∏≠‡∏ô‡πÑ‡∏ú‡πà", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏™‡∏ß‡∏ô‡∏ú‡∏•‡πÑ‡∏°‡πâ", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", 30.5, 4575, "=H21/G21", "20/04/2567", "0889012345", "@somsak", 228750, "‚úó ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° (‡∏ö‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö)"],
    
    # Row 22: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ç‡∏µ‡∏î
    [17, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å", "‡∏î‡∏≠‡∏ô‡πÑ‡∏ú‡πà", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏™‡∏ß‡∏ô‡∏ú‡∏•‡πÑ‡∏°‡πâ", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", 30, 4500, "=H22/G22", "20-04-2567", "0889012345", "@somsak", 225000, "‚úó ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ç‡∏µ‡∏î (-) ‡πÅ‡∏ó‡∏ô‡∏ó‡∏±‡∏ö (/)"],
    
    # Row 23: ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏°‡∏µ‡∏Ç‡∏µ‡∏î
    [18, "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏´‡∏ß‡∏≤‡∏¢‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏£‡∏±‡∏Å‡∏õ‡πà‡∏≤", "‡πÑ‡∏ú‡πà", 50, 2500, "=H23/G23", "25/04/2567", "089-012-3456", "@khiew", 125000, "‚úó ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏°‡∏µ‡∏Ç‡∏µ‡∏î"],
    
    # Row 24: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏µ comma
    [19, "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏´‡∏ß‡∏≤‡∏¢‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏£‡∏±‡∏Å‡∏õ‡πà‡∏≤", "‡πÑ‡∏ú‡πà", 50, 2500, "=H24/G24", "25/04/2567", "0890123456", "@khiew", "125,000", "‚úó ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏°‡∏µ comma (‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏±‡∏ö CSV)"],
    
    # Row 25: Trailing space
    [20, "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏´‡∏ß‡∏≤‡∏¢‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏£‡∏±‡∏Å‡∏õ‡πà‡∏≤", "‡πÑ‡∏ú‡πà", 50, 2500, "=H25/G25", "26/04/2567", "0890123456", "@khiew", 125000, "‚úó ‡∏°‡∏µ space ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î"],
    
    # Row 26: NULL ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    [21, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏û‡∏£‡∏∞‡∏õ‡∏ê‡∏°‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡πÅ‡∏î‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ú‡∏±‡∏Å", 10, "NULL", "#VALUE!", "30/04/2567", "0901234567", "@daeng", 50000, "‚úó NULL ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á"],
    
    # Row 27: ‡πÄ‡∏•‡∏Ç‡πÑ‡∏ó‡∏¢
    [22, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏û‡∏£‡∏∞‡∏õ‡∏ê‡∏°‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡πÅ‡∏î‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ú‡∏±‡∏Å", 10, 500, "=H27/G27", "30/04/2567", "‡πê‡πô‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó", "@daeng", 50000, "‚úó ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡πÑ‡∏ó‡∏¢"],
    
    # Row 28: Space ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤
    [23, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏û‡∏£‡∏∞‡∏õ‡∏ê‡∏°‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢ ‡πÅ‡∏î‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ú‡∏±‡∏Å", 10, 500, "=H28/G28", "30/04/2567", "0901234567", "@daeng", 50000, "‚úó ‡∏°‡∏µ space ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠"],
    
    # Row 29: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏•‡∏ö
    [24, "‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ", "‡∏≠‡∏π‡πà‡∏ó‡∏≠‡∏á", "‡∏à‡∏£‡πÄ‡∏Ç‡πâ‡∏™‡∏≤‡∏°‡∏û‡∏±‡∏ô", "‡∏ô‡∏≤‡∏á‡∏û‡∏¥‡∏° ‡∏£‡∏ß‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "‡∏Ç‡πâ‡∏≤‡∏ß", 200, 10000, "=H29/G29", "01/05/2567", "0912345678", "@pim", -50000, "‚úó ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏•‡∏ö (‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ú‡∏¥‡∏î?)"],
    
    # Row 30: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô
    [25, "‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ", "‡∏≠‡∏π‡πà‡∏ó‡∏≠‡∏á", "‡∏à‡∏£‡πÄ‡∏Ç‡πâ‡∏™‡∏≤‡∏°‡∏û‡∏±‡∏ô", "‡∏ô‡∏≤‡∏á‡∏û‡∏¥‡∏° ‡∏£‡∏ß‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "‡∏Ç‡πâ‡∏≤‡∏ß", 200, 10000, "=H30/G30", "2567/05/01", "0912345678", "@pim", 500000, "‚úó ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏õ‡∏µ/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏ß‡∏±‡∏ô"],
]

# Write data starting from row 6
for row_idx, row_data in enumerate(data, 6):
    is_correct = "‚úì" in str(row_data[-1])
    for col_idx, value in enumerate(row_data, 1):
        cell = ws.cell(row=row_idx, column=col_idx, value=value)
        cell.border = thin_border
        cell.alignment = Alignment(vertical='center', wrap_text=True)
        
        if is_correct:
            cell.fill = correct_fill
        else:
            cell.fill = error_fill

# ============================================
# ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î #2: Merged Cells ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏£‡∏ß‡∏°‡πÅ‡∏ñ‡∏ß)
# ============================================
# Row 31-32: ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î - Merged cells in data
ws.merge_cells('A31:A32')  # ‡∏•‡∏≥‡∏î‡∏±‡∏ö merged
ws['A31'] = 26
ws.merge_cells('B31:B32')  # ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î merged
ws['B31'] = "‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå"
ws.merge_cells('C31:C32')  # ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ merged
ws['C31'] = "‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô"
ws.merge_cells('D31:D32')  # ‡∏ï‡∏≥‡∏ö‡∏• merged
ws['D31'] = "‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô"

# Row 31 - First farmer
ws['E31'] = "‡∏ô‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å ‡∏´‡∏≤‡∏î‡∏ó‡∏£‡∏≤‡∏¢"
ws['F31'] = "‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î"
ws['G31'] = 30
ws['H31'] = 9000
ws['I31'] = "=H31/G31"
ws['J31'] = "01/06/2567"
ws['K31'] = "0934567890"
ws['L31'] = "@ek"
ws['M31'] = 270000
ws['N31'] = "‚úó Merged cells: ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏ï‡∏≥‡∏ö‡∏• ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô 2 ‡πÅ‡∏ñ‡∏ß"

# Row 32 - Second farmer (same location, merged)
ws['E32'] = "‡∏ô‡∏≤‡∏á‡πÇ‡∏ó ‡∏´‡∏≤‡∏î‡∏™‡∏ß‡∏¢"
ws['F32'] = "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß"
ws['G32'] = 20
ws['H32'] = 4000
ws['I32'] = "=H32/G32"
ws['J32'] = "02/06/2567"
ws['K32'] = "0945678901"
ws['L32'] = "@tho"
ws['M32'] = 120000
ws['N32'] = "‚úó Merged cells: ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Import ‡πÄ‡∏Ç‡πâ‡∏≤ Looker ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ"

# Style merged data rows
for row in [31, 32]:
    for col in range(1, 15):
        cell = ws.cell(row=row, column=col)
        cell.border = thin_border
        cell.fill = error_fill
        cell.alignment = Alignment(vertical='center', wrap_text=True)

# ============================================
# ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î #3: ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏° (Summary Row) ‡∏õ‡∏ô‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
# ============================================
# Row 33: Empty row
# Row 34: Summary row (bad practice)
ws['A34'] = "‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
ws.merge_cells('A34:F34')
ws['A34'].font = Font(bold=True)
ws['A34'].fill = PatternFill(start_color="FFF9C4", end_color="FFF9C4", fill_type="solid")
ws['G34'] = "=SUM(G6:G32)"
ws['H34'] = "=SUM(H6:H32)"
ws['I34'] = ""
ws['J34'] = ""
ws['K34'] = ""
ws['L34'] = ""
ws['M34'] = "=SUM(M6:M32)"
ws['N34'] = "‚úó ‡πÅ‡∏ñ‡∏ß‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°‡∏õ‡∏ô‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å Import ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢"
for col in range(1, 15):
    cell = ws.cell(row=34, column=col)
    cell.border = thin_border
    cell.fill = PatternFill(start_color="FFF9C4", end_color="FFF9C4", fill_type="solid")

# ============================================
# ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î #4: ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡∏≤‡∏£‡∏≤‡∏á
# ============================================
ws['A36'] = "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏õ‡∏µ 2567"
ws.merge_cells('A36:N36')
ws['A37'] = "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥: ‡∏ô‡∏≤‡∏¢‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á  ‡πÇ‡∏ó‡∏£. 02-123-4567"
ws.merge_cells('A37:N37')
ws['A38'] = "‚úó ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Import ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"
ws.merge_cells('A38:N38')
ws['A38'].fill = error_fill

# Adjust column widths
column_widths = [8, 15, 14, 14, 22, 12, 12, 12, 10, 16, 15, 12, 14, 50]
for col_idx, width in enumerate(column_widths, 1):
    ws.column_dimensions[openpyxl.utils.get_column_letter(col_idx)].width = width

# Set row heights
ws.row_dimensions[1].height = 25
ws.row_dimensions[2].height = 20
ws.row_dimensions[4].height = 25
ws.row_dimensions[5].height = 25

# Freeze panes at row 6 (after headers)
ws.freeze_panes = 'A6'

# ============================================
# Sheet 2: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Clean Data)
# ============================================
ws2 = wb.create_sheet(title="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")

# Simple single-row headers (no merged cells)
clean_headers = [
    "‡∏•‡∏≥‡∏î‡∏±‡∏ö", "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠", "‡∏ï‡∏≥‡∏ö‡∏•", "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£", "‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å",
    "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)", "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏Å‡∏Å.)", "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï/‡πÑ‡∏£‡πà", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
    "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£", "LINE ID", "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏ö‡∏≤‡∏ó)"
]

# Write headers
for col_idx, header in enumerate(clean_headers, 1):
    cell = ws2.cell(row=1, column=col_idx, value=header)
    cell.font = header_font
    cell.fill = header_fill
    cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
    cell.border = thin_border

# Clean data - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
clean_data = [
    [1, "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø", "‡∏ö‡∏≤‡∏á‡∏Å‡∏≠‡∏Å‡∏ô‡πâ‡∏≠‡∏¢", "‡∏≠‡∏£‡∏∏‡∏ì‡∏≠‡∏°‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ", "‡∏Ç‡πâ‡∏≤‡∏ß", 50, 2500, "=H2/G2", "15/03/2567", "0812345678", "@somchai", 125000],
    [2, "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø", "‡∏ö‡∏≤‡∏á‡∏Å‡∏≠‡∏Å‡∏ô‡πâ‡∏≠‡∏¢", "‡∏≠‡∏£‡∏∏‡∏ì‡∏≠‡∏°‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ", "‡∏Ç‡πâ‡∏≤‡∏ß", 50, 2500, "=H3/G3", "15/03/2567", "0812345678", "@somchai", 125000],
    [3, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏á‡∏°‡∏≤‡∏•‡∏µ ‡∏™‡∏ß‡∏ô‡∏î‡∏≠‡∏Å", "‡∏ú‡∏±‡∏Å", 5, 300, "=H4/G4", "20/03/2567", "0823456789", "@mali", 15000],
    [4, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏á‡∏°‡∏≤‡∏•‡∏µ ‡∏™‡∏ß‡∏ô‡∏î‡∏≠‡∏Å", "‡∏ú‡∏±‡∏Å", 5, 300, "=H5/G5", "20/03/2567", "0823456789", "@mali", 15000],
    [5, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏", "‡∏ú‡∏±‡∏Å", 10, 500, "=H6/G6", "21/03/2567", "0823456789", "@noname", 25000],
    [6, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•", "‡∏®‡∏≤‡∏•‡∏≤‡∏¢‡∏≤", "‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡∏£‡∏±‡∏Å‡∏ô‡∏≤", "‡∏Ç‡πâ‡∏≤‡∏ß", 100, 5000, "=H7/G7", "30/03/2567", "0834567890", "@prayuth", 250000],
    [7, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡πÇ‡∏û‡∏ò‡∏≤‡∏£‡∏≤‡∏°", "‡πÄ‡∏ï‡∏≤‡∏õ‡∏π‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏ó‡∏≠‡∏á‡∏î‡∏µ ‡∏°‡∏±‡πà‡∏á‡∏°‡∏µ", "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß", 15, 3000, "=H8/G8", "01/04/2567", "0812345678", "@tongdee", 180000],
    [8, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡πÇ‡∏û‡∏ò‡∏≤‡∏£‡∏≤‡∏°", "‡πÄ‡∏ï‡∏≤‡∏õ‡∏π‡∏ô", "‡∏ô‡∏≤‡∏¢‡∏ó‡∏≠‡∏á‡∏î‡∏µ ‡∏°‡∏±‡πà‡∏á‡∏°‡∏µ", "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß", 15, 3000, "=H9/G9", "01/04/2567", "0812345678", "@tongdee", 180000],
    [9, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡πÇ‡∏û‡∏ò‡∏≤‡∏£‡∏≤‡∏°", "‡πÄ‡∏ï‡∏≤‡∏õ‡∏π‡∏ô", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏î‡∏≤ ‡∏£‡∏±‡∏Å‡∏©‡πå‡∏î‡∏¥‡∏ô", "‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á", 3, 150, "=H10/G10", "05/04/2567", "0845678901", "@suda", 7500],
    [10, "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏î‡∏µ", "‡∏Å‡∏∏‡πâ‡∏á", 20, 10000, "=H11/G11", "10/04/2567", "0856789012", "@wichai", 500000],
    [11, "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏°‡∏´‡∏≤‡∏ä‡∏±‡∏¢", "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏î‡∏µ", "‡∏Å‡∏∏‡πâ‡∏á", 20, 10000, "=H12/G12", "10/04/2567", "0856789012", "@wichai", 500000],
    [12, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô", "‡∏Å‡∏£‡∏∞‡∏ï‡∏µ‡∏ö", "‡∏ô‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡∏∏‡∏ç‡∏°‡∏µ", "‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î", 25, 12500, "=H13/G13", "15/04/2567", "0867890123", "@noi", 62500],
    [13, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô", "‡∏Å‡∏£‡∏∞‡∏ï‡∏µ‡∏ö", "‡∏ô‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà ‡πÉ‡∏à‡∏Å‡∏•‡πâ‡∏≤", "‡∏≠‡πâ‡∏≠‡∏¢", 100, 50000, "=H14/G14", "16/04/2567", "0878901234", "@yai", 250000],
    [14, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô", "‡∏Å‡∏£‡∏∞‡∏ï‡∏µ‡∏ö", "‡∏ô‡∏≤‡∏¢‡πÉ‡∏´‡∏ç‡πà ‡πÉ‡∏à‡∏Å‡∏•‡πâ‡∏≤", "‡∏≠‡πâ‡∏≠‡∏¢", 50, 5000, "=H15/G15", "17/04/2567", "0878901234", "@yai", 25000],
    [15, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å", "‡∏î‡∏≠‡∏ô‡πÑ‡∏ú‡πà", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏™‡∏ß‡∏ô‡∏ú‡∏•‡πÑ‡∏°‡πâ", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", 30, 4500, "=H16/G16", "20/04/2567", "0889012345", "@somsak", 225000],
    [16, "‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ", "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å", "‡∏î‡∏≠‡∏ô‡πÑ‡∏ú‡πà", "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏™‡∏ß‡∏ô‡∏ú‡∏•‡πÑ‡∏°‡πâ", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", 30, 4500, "=H17/G17", "20/04/2567", "0889012345", "@somsak", 225000],
    [17, "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏´‡∏ß‡∏≤‡∏¢‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏£‡∏±‡∏Å‡∏õ‡πà‡∏≤", "‡πÑ‡∏ú‡πà", 50, 2500, "=H18/G18", "25/04/2567", "0890123456", "@khiew", 125000],
    [18, "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏´‡∏ß‡∏≤‡∏¢‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏£‡∏±‡∏Å‡∏õ‡πà‡∏≤", "‡πÑ‡∏ú‡πà", 50, 2500, "=H19/G19", "25/04/2567", "0890123456", "@khiew", 125000],
    [19, "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏´‡∏ß‡∏≤‡∏¢‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏£‡∏±‡∏Å‡∏õ‡πà‡∏≤", "‡πÑ‡∏ú‡πà", 50, 2500, "=H20/G20", "26/04/2567", "0890123456", "@khiew", 125000],
    [20, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏û‡∏£‡∏∞‡∏õ‡∏ê‡∏°‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡πÅ‡∏î‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ú‡∏±‡∏Å", 10, 500, "=H21/G21", "30/04/2567", "0901234567", "@daeng", 50000],
    [21, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏û‡∏£‡∏∞‡∏õ‡∏ê‡∏°‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡πÅ‡∏î‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ú‡∏±‡∏Å", 10, 500, "=H22/G22", "30/04/2567", "0901234567", "@daeng", 50000],
    [22, "‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏û‡∏£‡∏∞‡∏õ‡∏ê‡∏°‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå", "‡∏ô‡∏≤‡∏¢‡πÅ‡∏î‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ú‡∏±‡∏Å", 10, 500, "=H23/G23", "30/04/2567", "0901234567", "@daeng", 50000],
    [23, "‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ", "‡∏≠‡∏π‡πà‡∏ó‡∏≠‡∏á", "‡∏à‡∏£‡πÄ‡∏Ç‡πâ‡∏™‡∏≤‡∏°‡∏û‡∏±‡∏ô", "‡∏ô‡∏≤‡∏á‡∏û‡∏¥‡∏° ‡∏£‡∏ß‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "‡∏Ç‡πâ‡∏≤‡∏ß", 200, 10000, "=H24/G24", "01/05/2567", "0912345678", "@pim", 500000],
    [24, "‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ", "‡∏≠‡∏π‡πà‡∏ó‡∏≠‡∏á", "‡∏à‡∏£‡πÄ‡∏Ç‡πâ‡∏™‡∏≤‡∏°‡∏û‡∏±‡∏ô", "‡∏ô‡∏≤‡∏á‡∏û‡∏¥‡∏° ‡∏£‡∏ß‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "‡∏Ç‡πâ‡∏≤‡∏ß", 200, 10000, "=H25/G25", "01/05/2567", "0912345678", "@pim", 500000],
    [25, "‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå", "‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô", "‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô", "‡∏ô‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å ‡∏´‡∏≤‡∏î‡∏ó‡∏£‡∏≤‡∏¢", "‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î", 30, 9000, "=H26/G26", "01/06/2567", "0934567890", "@ek", 270000],
    [26, "‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå", "‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô", "‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô", "‡∏ô‡∏≤‡∏á‡πÇ‡∏ó ‡∏´‡∏≤‡∏î‡∏™‡∏ß‡∏¢", "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß", 20, 4000, "=H27/G27", "02/06/2567", "0945678901", "@tho", 120000],
]

# Write clean data starting from row 2
for row_idx, row_data in enumerate(clean_data, 2):
    for col_idx, value in enumerate(row_data, 1):
        cell = ws2.cell(row=row_idx, column=col_idx, value=value)
        cell.border = thin_border
        cell.alignment = Alignment(vertical='center')
        cell.fill = correct_fill

# Adjust column widths for Sheet 2
clean_column_widths = [8, 18, 14, 14, 22, 12, 12, 12, 10, 16, 15, 12, 14]
for col_idx, width in enumerate(clean_column_widths, 1):
    ws2.column_dimensions[openpyxl.utils.get_column_letter(col_idx)].width = width

# Freeze panes at row 2 (after header)
ws2.freeze_panes = 'A2'

# Save the workbook
filename = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£_‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö.xlsx'
wb.save(filename)
print(f"‚úì ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: {filename}")
print(f"‚úì ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: {len(data)} ‡πÅ‡∏ñ‡∏ß + 2 ‡πÅ‡∏ñ‡∏ß Merged + Summary")
print("\nüìã ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÑ‡∏ß‡πâ:")
print("  1. ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô (Multi-level Headers)")
print("  2. Merged Cells ‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á")
print("  3. Merged Cells ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏£‡∏ß‡∏°‡πÅ‡∏ñ‡∏ß)")
print("  4. ‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")
print("  5. ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏∞‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô (Inconsistent)")
print("  6. ‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏•‡∏ö")
print("  7. ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ó‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç")
print("  8. Missing Values (‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á)")
print("  9. ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö/‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á")
print(" 10. N/A, NULL ‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á")
print(" 11. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥ (Duplicates)")
print(" 12. Outliers (‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥)")
print(" 13. Logic Errors")
print(" 14. ‡πÄ‡∏•‡∏Ç‡πÑ‡∏ó‡∏¢‡∏õ‡∏ô‡πÄ‡∏•‡∏Ç‡∏≠‡∏≤‡∏£‡∏ö‡∏¥‡∏Å")
print(" 15. Trailing/Leading Spaces")
print(" 16. Formula Errors (#VALUE!, #DIV/0!)")
print(" 17. ‡πÅ‡∏ñ‡∏ß‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°‡∏õ‡∏ô‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")
print(" 18. ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡∏≤‡∏£‡∏≤‡∏á")
